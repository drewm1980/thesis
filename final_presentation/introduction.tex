\frame{\tableofcontents}
\section{Introduction}

\frame{
\frametitle{Why is face recognition important?}
{\em Make the initiation of
authenticated interaction with a machine as natural as making eye contact with
another human.}
\begin{itemize}
\item Consumer Electronics: Phones, Televisions, Music Systems, Game Systems
\item Access Control: Workplace, Home, Automobile
\item Home automation: Light switches, HVAC
\item Computer Access: ATM, grocery store checkout
}

\subsection{Introduction}
\frame{
\frametitle{Why is 2D face recognition important for these applications?}
\begin{itemize}
\item Non-contact
\item Potentially faster than gait or voice recognition
\item No special hardware needed for recognition (unlike Iris recognition)
\item Attacks would probably be obvious to bystanders
\item Recognized person need not do anything
\end{itemize}
}

\frame{
\frametitle{Why is face recognition challenging?}
\begin{itemize}
\item Three factors dramatically affect the appearance of a face:
\begin{enumerate}
\item Illumination Variation: The appearance of the face depends very strongly on the illumination
\item Alignment Variation: The image depends on the orientation between the camera and subject 
\item Occlusion: Often parts of the face image are covered by other objects
\end{enumerate}
\end{itemize}
}

%\item Classical algorithms, such as Eigenfaces, LDA, Nearest Neighbor, and Nearest Subspace perform poorly when confronted with test images taken outside of the lab.

\frame{
\frametitle{A promising recent direction in face recognition research}
\begin{center}
\vspace{-.2in}
\includegraphics[width=.3\textwidth]{images/bouqet.pdf}\\
\vspace{-.2in}
\end{center}
\begin{itemize}
\item One very promising direction in face recognition research,
{\bf Sparse Representation based Classification (SRC)} [Wright et.\ al. PAMI 2009] achieves state-of-the-art performance on aligned public datasets.
\item This is a solid foundation, but it is incomplete:
	\begin{itemize}
	\item Assumed perfectly aligned images
	\item Assumed a sufficient number of training illuminations taken under different illuminations
\end{itemize}
\end{itemize}
}

\frame{
\frametitle{The Goal of the Research}
{\large I will demonstrate a complete and scalable face recognition system that can handle  {\bf illumination variation, alignment error, and realistic occlusions.}}\\
\vspace{.2in}
This encompases the following major contributions:
\begin{itemize}
\item Determine what {\bf training illuminations} are sufficient and build an {\bf acquisition system} capable of capturing them
\item Design algorithm for {\bf automatically aligning} test images to training images
\item Algorithmic improvements to improve recognition rate
\item Algorithmic improvements to improve recognitieon speed
\item Highly optimized parallel implementations for real-time face recognition
\end{itemize}
}

%\frame{\tableofcontents[currentsection, currentsubsection]}
\subsection{Illumination Model}
\input{promo}

%\frame{
%\frametitle{Linear Illumination Models}
%\hspace{.1\textwidth}\includegraphics[height=0.8\textheight]{images/linear_illumination_model.pdf}
%}

\frame{
\frametitle{Linear Illumination Models}
\vspace{-5mm}\begin{center}
\includegraphics[width=0.9\textwidth]{images/shadow_example}
\end{center}\vspace{-5mm}
\item Despite Shadowing and Specularities Images still linear WRT illumination
\item We can make Shadows and Specularities our Friends rather than our Enemies
\item {\em Experimentally} determine which training illuminations needed
\end{itemize}
}

%\subsection{Acquisition System}
\frame{
\frametitle{Acquisition System}
\begin{columns}

\includegraphics[width=0.3\textwidth]{images/camera_rig_drawings/perspective.pdf}
Projector-Based system
\begin{itemize}
\item Easy to re-configure projector geometry
\item Trivial to change illumination patterns
\item Easier to construct and deploy
\item Very complete angular illumination coverage
\end{itemize}
}

\frame{
\frametitle{Training Illumination Rig}
\begin{columns}
\begin{column}{.5\textwidth}
\begin{center}
Side View\\
\includegraphics[width=\textwidth]{images/camera_rig_drawings/coverage_side.pdf}
\end{center}
\end{column}
\begin{column}{.5\textwidth}
\begin{center}
Top View\\
\includegraphics[width=\textwidth]{images/camera_rig_drawings/coverage_top.pdf}
\end{center}
\end{column}
\end{columns}
}

%\frame{
%\frametitle{So many projector pixels, so little time}
%\begin{itemize}
%\item Need to narrow down the illumination possibilities.
%\item How densely do we need to sample the illumination sphere?
%\begin{itemize}
%\item Try multiple sets of illuminations
%\item Double the resolution in one direction each time
%\end{itemize}
%\item How much coverage do we need?
%\begin{itemize}
%\item Try multiple sets of illuminations
%\item Gradually increase the coverage radially out from known-important illuminations
%\end{itemize}
%\end{itemize}
%\begin{center}
%\includegraphics[height=.4\textheight]{figures_cvpr/coverage_experiment_asplode_white.png}
%\end{center}
%}

%\renewcommand{\imagesizestring}{height}
%\frame{\frametitle{Illumination Experiment Results}
%\renewcommand{\imagesizea}{0.55\textheight}
%\begin{center}
%\begin{tabular}{cc}
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/illum_results/granularity_sunset.pdf} &
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/illum_results/coverage_sunset.pdf} \\
%(a) Granularity & (b) Coverage
%\end{tabular}\vspace{2mm}
%\end{center}
%}

\frame{
\renewcommand{\imagesizestring}{height}
\renewcommand{\imagesizea}{0.41\textheight}
\frametitle{Experimentally Motivated Illumination Set}
\begin{tabular}{cc}
\includegraphics[\imagesizestring = \imagesizea]{images/camera_rig_drawings/side_front.pdf} & \includegraphics[\imagesizestring = \imagesizea]{images/illuminations/front.png}\\
\includegraphics[\imagesizestring = \imagesizea]{images/camera_rig_drawings/side_back.pdf} & \includegraphics[\imagesizestring = \imagesizea]{images/illuminations/back.png}
\end{tabular}
}

%\frame{\frametitle{Sample Training Images, Originals}
%\includegraphics[width=\textwidth]{images/training_contact_sheet.png}
%}

\subsection{Alignment}
%\input{promo.tex}

\frame{
\frametitle{Image Embedding}
\vspace{-3mm}
\begin{equation*}
(\hat \x, \hat \e,\hat \tau_i) = \argmin{\x,\e,\tau_i \in T} \| \e \|_1 \quad \subj \quad \y \circ \tau_i = A_i \x + \e
\end{equation*}
\begin{center}
\includegraphics[width=.50\textwidth]{figures_embedding/training_embedding.pdf}\\
$A = [ A_1 \mid A_2 \mid \dots \mid A_K ] \in \Re^{m \times n}$
\end{center}
}

%\frame{
%\frametitle{Sparse Representation with Warping}
%\vspace{-.1in} {\footnotesize
%\begin{itemize}
%\item<1-> SRC uses the following minimization:
%\begin{equation*}
%(\hat{\x}, \hat{\e}) = \argmin{\x,\e} \| \x \|_1 + \| \e\|_1 \quad \subj \quad \underbrace{\y_0}_{\mbox{\tiny test image}} = \underbrace{A}_{\mbox{\tiny training data}} \underbrace{\x}_{\mbox{\tiny coefficients}} + \underbrace{\e}_{\mbox{\tiny sparse error}}
%\end{equation*}
%\begin{center}{\color{blue} Assumes $\y$ aligned}\end{center}
%\item<2-> For an un-aligned test image:
%\begin{equation*}
%(\hat{\x}, \hat{\e}, \hat{\tau}) = \argmin{\x,\e,\tau \in T} \| \x \|_1 + \| \e \|_1 \quad \subj \quad  \underbrace{\y}_{\mbox{\tiny un-aligned}} \circ \underbrace{\tau}_{\mbox{\tiny transformation}} = A \x + \e
%\end{equation*}
%\begin{center}{\color{blue}many local minima! scales badly!}\vspace{-.05in}\end{center}
%\item<3-> Per-User alignment:
%\begin{equation*}
%(\hat \x, \hat \e,\hat \tau_i) = \argmin{\x,\e,\tau_i \in T} \| \e \|_1 \quad \subj \quad \y \circ \tau_i = A_i \x + \e
%\end{equation*}
%\begin{center}{\color{blue}not convex!}\vspace{-.05in}\end{center}
%\item<4-> Linearize w.r.t. parameterization of $\tau$:
%\begin{equation*}
%(\hat \x, \hat \e, \Delta\hat\tau_i) = \argmin{\x,\e,\Delta\tau_i \in T} \| \e \|_1 \quad \subj \quad \y\circ \tau + \underbrace{J}_{\mbox{\tiny Jacobian}} \Delta \tau_i = A_i \x + \e
%\end{equation*}
%\end{itemize}
%}}

%\frame{
%\frametitle{Iterative Alignment}
%\begin{itemize}
%\item Since we linearized $\y \circ \tau_i$, we have to iterate between solving
%\begin{eqnarray*}
%(\hat \x, \hat \e, \Delta\hat\tau_i) &\leftarrow& \argmin{\x,\e,\Delta\tau_i \in T} \| \e \|_1 \quad \subj \quad \y\circ \tau_i + J \Delta \tau_i = A_i \x + \e \\
%\tau_i &\leftarrow& \tau_i + \Delta\hat \tau_i
%\end{eqnarray*}
%and re-computing the Jacobian $J$ about the new point $\y\circ (\tau_i + \Delta \tau_i)$.
%\item To avoid degenerate solutions, normalize the {\em warped} test image:
%\begin{equation*}
%\tilde\y(\tau) = \frac{\y\circ\tau}{||\y\circ\tau||_2}
%\end{equation*}
%\item Normalize columns of $A$ to unit $\ell^2$ norm.
%\item Enforce constraint $\x>0$.
%\item Can extend this to multiscale
%\end{itemize}
%}

\frame{
\frametitle{Recognition Step}
\begin{itemize}
\item Re-sample training database using inverted $\tau_i$ from alignment step:
\begin{equation*}
A \leftarrow \left[ A_1 \circ \tau_1^-1 \ldots A_i \circ \tau_i^-1\ldots \right]
\end{equation*}
\item Perform global optimization:
\begin{equation*}
(\hat{\x}, \hat{\e}) = \argmin{\x,\e} \| \x \|_1 + \| \e\|_1 \quad \subj \quad \y = \underbrace{A}_{\mbox{\tiny aligned}} \x + \e
\end{equation*}
\item Return user with lowest residual $||\y - A_i \hat x_i||_2$. 
\end{itemize}
}

\frame{
\frametitle{Recognition Pipeline}
\begin{center}
\includegraphics[width=.75\textwidth]{figures_embedding/pipeline.pdf}
\end{center}
}


%\frame{\frametitle{Alignment Examples}
%$\ell^1$ and $\ell^2$ minimization alignment comparison
%\begin{columns}
%\begin{column}{0.5\textwidth}
%\renewcommand{\imagesizestring}{height}
%\renewcommand{\imagesizea}{0.2\textheight}
%\begin{tabular}[t]{@{}c@{}c@{}c@{}c@{}m{.2\textwidth}}
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/L1_cropped} &
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/y_warp_L1} &
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/y_hat_L1} &
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/e_L1} &
%$\|\e\|_1$\\[-.05in]
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/L2_cropped} &
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/y_warp_L2} &
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/y_hat_L2} &
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/e_L2} &
%$\|\e\|_2$ \\[-.1in]
%{\tiny Face Boundary} & {\tiny Aligned Test} & {\tiny Reconstruction} & {\tiny $|$Error$|$}
%\end{tabular}
%\end{column}
%\begin{column}{0.5\textwidth}
%\renewcommand{\imagesizestring}{height}
%\renewcommand{\imagesizea}{0.2\textheight}
%Alignment tolerance for out-of-plane pose variation
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/21}
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/19}
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/17}
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/15}
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/13}\\
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/11}
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/09}
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/7}
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/5}
%\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/3}\\
%Alignment using a projective transformation works up to about $45^{\circ}$.
%\end{column}
%\end{columns}
%}

\subsection{Experiments}




\renewcommand{\imagesizestring}{height}
\renewcommand{\imagesizea}{0.36\textheight}
\renewcommand{\gapsizea}{-0mm}
\frame{\frametitle{Alignment region of attraction}
%\begin{tabular}{cc}
\begin{center}
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/promo/alignment_and_detector.png}
\includegraphics[\imagesizestring= \imagesizea]{figures_cvpr/translation_fig3.png}
\includegraphics[\imagesizestring= \imagesizea]{figures_cvpr/translation_rotation_fig1.png}
\end{center}
%\end{tabular}
\vspace{0mm}
{\tiny
\begin{itemize}
\item Translation is expressed as a fraction of outer eye corner distance.
\item In-plane rotation is expressed in degrees. 
\item Probability of convergence from synthetic transformations to hand-clicked ground truth
\item Training: CMU Multi-PIE, 120 subjects, 11 illuminations, session 2.  Re-sampled to $60 \times 80$ pixels.
\item Testing: 1 new illumination from session 3
\item Viola Jones' face detector average error on this data set falls safely within our region of attraction
\end{itemize}}
}


\frame{\frametitle{Alignment Examples}
{\footnotesize
\vspace{-.1in}
Comparison of $\ell^1$ and $\ell^2$ minimization:
\renewcommand{\imagesizestring}{height}
\renewcommand{\imagesizea}{0.15\textheight}
\vspace{-.05in}
\begin{center}
\begin{tabular}[t]{b{.3in}cccc}
$\min \|\e\|_2$\vfill &
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/L2_cropped} &
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/y_warp_L2} &
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/y_hat_L2} &
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/e_L2} \\
$\min \|\e\|_1$\vfill &
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/L1_cropped} &
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/y_warp_L1} &
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/y_hat_L1} &
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/e_L1} \\
& {\tiny Face Boundary} & {\tiny Aligned Test} & {\tiny Reconstruction} & {\tiny $|$Error$|$}
\end{tabular}
\end{center}

%$\ell^1$ and $\ell^2$ minimization alignment comparison
\renewcommand{\imagesizestring}{height}
\renewcommand{\imagesizea}{0.15\textheight}
\vspace{-.1in}

%Alignment tolerance for out-of-plane pose variation
Alignment using a projective transformation works up to about $45^{\circ}$.
\vspace{-.05in}
\begin{center}
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/21}
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/19}
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/17}
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/15}
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/13}\\
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/11}
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/09}
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/7}
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/5}
\includegraphics[\imagesizestring=\imagesizea]{figures_cvpr/3}\\
\end{center}}
}

\frame{\frametitle{Large Scale Multi PIE experiments}
\begin{center}
\begin{tabular}{|l|c|c|c|c|}
\hline
Rec. Rates & Session 2 & Session 3 & Session 4  \\
\hline
\hline
LDA$_d$ (LDA$_m$) & 5.1 (49.4)\%  & 5.9 (44.3)\% & 4.3 (47.9)\%  \\
\hline
NN$_d$ (NN$_m$)  & 26.4 (67.3)\% & 24.7 (66.2)\% & 21.9 (62.8)\%  \\
\hline
NS$_d$ (NS$_m$) &  30.8 (77.6)\% & 29.4 (74.3)\% & 24.6 (73.4)\% \\
\hline
{Algorithm 1} & {\bf 91.4} \% & {\bf 90.3} \% & {\bf 90.2} \% \\
\hline
\end{tabular}
\end{center}
\begin{columns}
\begin{column}{0.5\textwidth}
\begin{itemize}
{\footnotesize
\item Training: all 249 subj. from session 1\\7 frontal illuminations
\item Testing: all users, from sessions 2-4\\ all 20 illuminations 
\item Use the 88 users not in session 1 for validation
\item Our Algorithm 1 used face detector; no manual intervention
\item subscript m for manual alignment, subscript d for detector
\item neutral expression
}
\end{itemize}
\end{column}
\begin{column}{0.5\textwidth}
\begin{center}
\includegraphics[width=\textwidth]{figures_cvpr/roc3.png}
\end{center}
\end{column}
\end{columns}
}



%%%Cause of errors Our algorithm's errors are mostly caused by a few subjects who significantly change their appearances between sessions (such as hair, facial hair, and eyeglasses). Some representative examples are shown in %Figure \ref{fig:failed-examples}. In fact, for those subjects, alignment and recognition fail on almost all test illuminations.\vspace{0mm} %This may be due the limited number of illuminations present in the training. \vspace{0mm}
%%%\begin{figure}

\renewcommand{\imagesizestring}{width}
\renewcommand{\imagesizea}{0.16\textwidth}
\frame{
\frametitle{Representative examples of failed Multi-PIE subjects}
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/079_01_01_051_08.png} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/130_01_01_051_08.png}
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/163_01_01_051_08.png} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/175_01_01_051_08.png} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/118_01_01_051_08.png} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/223_01_01_051_08.png}\\
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/079_02_01_051_08.png} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/130_02_01_051_08.png} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/163_02_01_051_08.png} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/175_02_01_051_08.png} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/118_02_01_140_08.png} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/223_02_01_140_08.png}\\
Trouble when large changes in the appearance between training and testing
\begin{itemize}
\item Hair color, hair style
\item Eyeglasses
\item Facial Hair
\end{itemize}
}

% Experiments on our own training images

\renewcommand{\imagesizestring}{width}
\renewcommand{\imagesizea}{0.2\textwidth}
\frame{\frametitle{Experiments on our data set}
\small{
Training (common to all): 74 users, 38 images per user
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/examples/1/DSC_1319.JPG} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/examples/1/DSC_1531.JPG} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/examples/1/DSC_1574.JPG} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/examples/1/DSC_1622.JPG} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/examples/1/DSC_1786.JPG}\\
Testing: 242 images of 47 subjects, no glasses, frontal view $\Rightarrow \textbf{\color{red} 95.9\%}$ recognition.
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/examples/2/DSC_1448.JPG} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/examples/2/DSC_1585.JPG} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/examples/2/DSC_1588.JPG} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/examples/2/DSC_1666.JPG} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/examples/2/DSC_1874.JPG}\\
Testing: 109 images of 23 subjects with eyeglasses  $\Rightarrow \textbf{\color{red} 91.5\%}$ recognition.
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/examples/3/DSC_1572.JPG} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/examples/3/DSC_1587.JPG} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/examples/3/DSC_1623.JPG} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/examples/3/DSC_1652.JPG} 
\includegraphics[\imagesizestring =\imagesizea]{figures_cvpr/examples/3/DSC_1675.JPG}\\
Testing: 19 images of 14 subjects with sunglasses $\Rightarrow \textbf{\color{red}63.2\%}$ recognition.
}}



